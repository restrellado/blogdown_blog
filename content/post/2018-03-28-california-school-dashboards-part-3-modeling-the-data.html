---
title: 'California School Dashboards Part 3: Modeling the Data '
author: Ryan Estrellado
date: '2018-03-28'
slug: california-school-dashboards-part-3-modeling-the-data
categories: []
tags:
  - school_data
  - tidyverse 
draft: TRUE
---



<pre><code>## Warning: Removed 37 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 37 rows containing missing values (geom_point).</code></pre>
<p><img src="/post/2018-03-28-california-school-dashboards-part-3-modeling-the-data_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre><code>## # A tibble: 9 x 2
##   districtname data                
##   &lt;chr&gt;        &lt;list&gt;              
## 1 district_1   &lt;tibble [183 × 4]&gt;  
## 2 district_2   &lt;tibble [319 × 4]&gt;  
## 3 district_3   &lt;tibble [1,162 × 4]&gt;
## 4 district_4   &lt;tibble [45 × 4]&gt;   
## 5 district_5   &lt;tibble [141 × 4]&gt;  
## 6 district_6   &lt;tibble [1,037 × 4]&gt;
## 7 district_7   &lt;tibble [200 × 4]&gt;  
## 8 district_8   &lt;tibble [1,201 × 4]&gt;
## 9 district_9   &lt;tibble [36 × 4]&gt;</code></pre>
<pre class="r"><code>dist_mod &lt;- function(d) {
  lm(currstatus_ela ~ currstatus_math, data = d)
}</code></pre>
<pre class="r"><code>mods &lt;- comb %&gt;% 
  mutate(model = map(data, dist_mod), 
         resids = map2(data, model, add_residuals)) 
mods</code></pre>
<pre><code>## # A tibble: 9 x 4
##   districtname data                 model    resids              
##   &lt;chr&gt;        &lt;list&gt;               &lt;list&gt;   &lt;list&gt;              
## 1 district_1   &lt;tibble [183 × 4]&gt;   &lt;S3: lm&gt; &lt;tibble [183 × 5]&gt;  
## 2 district_2   &lt;tibble [319 × 4]&gt;   &lt;S3: lm&gt; &lt;tibble [319 × 5]&gt;  
## 3 district_3   &lt;tibble [1,162 × 4]&gt; &lt;S3: lm&gt; &lt;tibble [1,162 × 5]&gt;
## 4 district_4   &lt;tibble [45 × 4]&gt;    &lt;S3: lm&gt; &lt;tibble [45 × 5]&gt;   
## 5 district_5   &lt;tibble [141 × 4]&gt;   &lt;S3: lm&gt; &lt;tibble [141 × 5]&gt;  
## 6 district_6   &lt;tibble [1,037 × 4]&gt; &lt;S3: lm&gt; &lt;tibble [1,037 × 5]&gt;
## 7 district_7   &lt;tibble [200 × 4]&gt;   &lt;S3: lm&gt; &lt;tibble [200 × 5]&gt;  
## 8 district_8   &lt;tibble [1,201 × 4]&gt; &lt;S3: lm&gt; &lt;tibble [1,201 × 5]&gt;
## 9 district_9   &lt;tibble [36 × 4]&gt;    &lt;S3: lm&gt; &lt;tibble [36 × 5]&gt;</code></pre>
<pre class="r"><code>resids &lt;- mods %&gt;% 
  unnest(resids)</code></pre>
<p>The original dataset did not include distance from three scores for any subgroup that had less than 11 students.</p>
<pre class="r"><code>ggplot(data = resids, aes(x = currstatus_math, y = resid)) + 
  geom_point(alpha = .25) + 
  facet_wrap(~ districtname) + 
  labs(title = &quot;Residuals Across Math Distance From Three Scores&quot;, 
       x = &quot;Math: Distance From Three&quot;, 
       y = &quot;Residuals&quot;)</code></pre>
<pre><code>## Warning: Removed 1356 rows containing missing values (geom_point).</code></pre>
<p><img src="/post/2018-03-28-california-school-dashboards-part-3-modeling-the-data_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = resids, aes(x = currstatus_math, y = resid, color = studentgroup)) + 
  geom_point(alpha = .25) + 
  facet_wrap(~ districtname) + 
  labs(title = &quot;Residuals Across Math Distance From Three Scores&quot;, 
       x = &quot;Math: Distance From Three&quot;, 
       y = &quot;Residuals&quot;)</code></pre>
<pre><code>## Warning: Removed 1356 rows containing missing values (geom_point).</code></pre>
<p><img src="/post/2018-03-28-california-school-dashboards-part-3-modeling-the-data_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><a href="https://www.cde.ca.gov/ta/ac/cm/documents/dashboardguidespring17.pdf">Definition of EL and ELO</a></p>
<pre class="r"><code>resids %&gt;% 
  mutate(elo = ifelse(studentgroup == &quot;English Learners Only&quot;, &quot;ELO&quot;, &quot;Not ELO&quot;)) %&gt;%
  ggplot(data = ., aes(x = currstatus_math, y = resid, color = elo)) + 
  geom_point(alpha = .5) + 
  facet_wrap(~ districtname) +
  labs(title = &quot;Residuals Across Math Distance From Three Scores&quot;, 
       x = &quot;Math: Distance From Three&quot;, 
       y = &quot;Residuals&quot;, 
       color = &quot;&quot;)</code></pre>
<pre><code>## Warning: Removed 1356 rows containing missing values (geom_point).</code></pre>
<p><img src="/post/2018-03-28-california-school-dashboards-part-3-modeling-the-data_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>When the residuals are negative, the actual datapoint was lower than what the model thought it should be.</p>
